(window["webpackJsonpreact-app"]=window["webpackJsonpreact-app"]||[]).push([[0],{167:function(e,t,n){e.exports=n(390)},172:function(e,t,n){},198:function(e,t){},200:function(e,t){},232:function(e,t){},233:function(e,t){},298:function(e,t){},389:function(e,t,n){},390:function(e,t,n){"use strict";n.r(t);var r=n(16),a=n.n(r),c=n(161),i=n.n(c),u=(n(172),n(5)),s=n.n(u),o=n(15),l=n(162),p=n(163),d=n(165),f=n(164),m=n(166),h=n(49),g=RegExp("(?:https?:\\/\\/)?(?:www.)?gfy(?:cat\\.com(?:\\/.{1,3})?(?!\\/(?:privacy|contact|upload|sign|leader|random|support|partners|gifbrewery|cajax\\/))|gur\\.com\\/view\\/\\d+)\\/+(?:(?:cajax\\/checkUrl|fetch)\\/(?:http.+)|(?!useraccount\\/|ifr\\/|(?:(?:\\w\\w\\/)?gifs\\/)?detail\\/)@?(?:[\\w.-]+)(?:\\/albums)?\\/(?:[\\w-]+).*|(?:ifr\\/|(?:(?:\\w\\w\\/)?gifs\\/)?detail\\/)?([a-zA-Z]{6,})(#?\\?direction=reverse)?.*)"),v=function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g.exec(t)[1],a={uri:"https://api.gfycat.com/v1/gfycats/"+r,json:!0},e.next=4,h.get(a).then((function(e){n=e.gfyItem.mp4Url})).catch((function(e){}));case 4:return e.abrupt("return",n||!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x={rule:g,get:v},b=n(49),w=RegExp("(?:https?:\\/\\/)?(?:www\\.)?(?:i\\.|m\\.)?imgur.com\\/(?!a/|gallery)([\\w]+)(\\..*)?"),y=function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=w.exec(t)[1],"mp4"!==(w.exec(t)[2]?w.exec(t)[2].slice(1):"none")){e.next=4;break}return e.abrupt("return",!1);case 4:return a={uri:"https://api.imgur.com/3/image/"+r,headers:{Authorization:"Client-ID 2cc61d0869511fd"},json:!0},e.next=7,b.get(a).then((function(e){"image/gif"!==e.data.type&&"video/mp4"!==e.data.type||(n="https://i.imgur.com/".concat(r,".mp4"))}));case 7:return e.abrupt("return",n||!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k={rule:w,get:y},I=n(49),S=RegExp("(?:https?:\\/\\/)?(?:www.)?(v\\.redd\\.it/[\\da-z]+).*"),j=function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=S.exec(t)[0],RegExp("^(?:https?:\\/\\/)").test(r)||(r="https://"+r),a="https://cors-anywhere.herokuapp.com/"+r+"/DASHPlaylist.mpd",e.next=5,I.get(a).then((function(e){var t;/DASH_1_2_M/.test(e)?t="DASH_1_2_M":/DASH_720/.test(e)?t="DASH_720":/DASH_600/.test(e)?t="DASH_600":/DASH_480/.test(e)?t="DASH_480":/DASH_360/.test(e)?t="DASH_360":/DASH_240/.test(e)&&(t="DASH_240"),n=r+"/"+t})).catch((function(e){}));case 5:return e.abrupt("return",n||!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D={rule:S,get:j},E=n(49),A=RegExp("(?:https?:\\/\\/)?(?:www\\.)?clips\\.twitch\\.tv\\/(?:embed\\?clip=)?(\\w+)"),_=function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=A.exec(t)[1],a={uri:"https://clips.twitch.tv/api/v2/clips/"+r,json:!0},e.next=4,E.get(a).then((function(e){var t=e.preview_image;n=t.replace(/-preview\.jpg.*/,".mp4")})).catch((function(e){}));case 4:return e.abrupt("return",n||!1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N={gfycat:x,imgur:k,reddit:D,twitch:{rule:A,get:_}},O=[{ext:"jpg",type:"image"},{ext:"jpeg",type:"image"},{ext:"bmp",type:"image"},{ext:"png",type:"image"},{ext:"gif",type:"image"},{ext:"mp4",type:"video"},{ext:"avi",type:"video"}],H=function(e){return Object.keys(N).map((function(e){return N[e]})).find((function(t){return t.rule.test(e)}))},T=function(e){var t=e.split(".").pop().split(/\?|\#/g).shift();return!!t&&O.find((function(e){return e.ext===t}))},L={getMedia:function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=T(t))){e.next=3;break}return e.abrupt("return",{url:t,type:n.type});case 3:if(!(r=H(t))){e.next=11;break}return e.next=7,r.get(t);case 7:return a=e.sent,e.abrupt("return",{url:a,type:"video"});case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},M=(n(389),"http://www.reddit.com"),C=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).getUrlToFetch=function(){var e=window.location.pathname;return e.length>1?M+e:"https://www.reddit.com/r/all"},n.addKeyboardEvents=function(){var e=13,t=77,r={left:37,up:38,right:39,down:40};document.addEventListener("keyup",function(){var a=Object(o.a)(s.a.mark((function a(c){return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(17!==c.keyCode){a.next=2;break}return a.abrupt("return");case 2:a.t0=c.keyCode,a.next=a.t0===r.left?5:a.t0===r.right?6:a.t0===e?7:a.t0===t?9:11;break;case 5:return a.abrupt("return",n.prevSlide());case 6:return a.abrupt("return",n.nextSlide());case 7:return console.log(n.cache),a.abrupt("break",12);case 9:return n.setMuted(!n.state.muted),a.abrupt("break",12);case 11:return a.abrupt("break",12);case 12:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},n.getData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.state.after;n.setState({loadingNextImages:!0}),fetch("".concat(n.settings.urlToFetch,".json?after=").concat(e)).then((function(e){return e.json()})).then(n.handleData)},n.handleData=function(){var e=Object(o.a)(s.a.mark((function e(t){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t.data&&t.data.after)){e.next=4;break}n.setState({after:t.data.after}),e.next=5;break;case 4:return e.abrupt("return");case 5:if(r=[],t.data.children&&(r=t.data.children),0!==r.length){e.next=9;break}return e.abrupt("return");case 9:return a=r.map(function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.data){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.addSlide({url:t.data.url||t.data.link_url,title:t.data.title||t.data.link_title,over18:t.data.over_18,subreddit:t.data.subreddit,commentsLink:M+t.data.permalink,data:t.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=12,Promise.all(a);case 12:-1===n.state.activeIndex&&n.setActiveIndex(0),null===t.data.after&&console.log("No more pages."),n.setState({loadingNextImages:!1});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.addSlide=function(){var e=Object(o.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getMedia(t.url);case 2:if(r=e.sent){e.next=8;break}return t.url=t.data.thumbnail,e.abrupt("return");case 8:t.url=r.url;case 9:if(t.type=r.type,n.setState({foundItems:!0}),!n.list.find((function(e){return e.url===t.url}))){e.next=13;break}return e.abrupt("return");case 13:n.list.push(t);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.prevSlide=function(){n.setActiveIndex(n.state.activeIndex-1),n.setPlaying(!0)},n.nextSlide=function(){var e=n.getNextItemIndex(n.state.activeIndex);n.setActiveIndex(e),n.setPlaying(!0)},n.setActiveIndex=function(e){n.state.activeIndex===e||e>n.list.length-1||e<0||0===n.list.length||(n.cache[e]||n.createDiv(e),n.setState({activeIndex:e,type:n.list[e].type}),n.refs.slider.innerHTML="",n.refs.slider.appendChild(n.cache[e]),n.cache[e].muted=n.state.muted,n.preloadNextItem(e),console.log(n.list[e]),n.isLastItem(e)&&n.getData())},n.isLastItem=function(e){return e===n.list.length-1},n.getNextItemIndex=function(e){return n.isLastItem(e)&&!n.state.loadingNextImages?0:e+1},n.preloadNextItem=function(e){var t=n.getNextItemIndex(e);n.cleanCache(),t<n.list.length&&n.createDiv(t)},n.cleanCache=function(){n.cache={}},n.createDiv=function(e){var t,r=n.list[e];"image"===r.type?((t=document.createElement("div")).className="clouds",t.style.backgroundImage="url('".concat(r.url,"')"),t.style.backgroundRepeat="no-repeat",t.style.backgroundSize="contain",t.style.backgroundPosition="center center"):"video"===r.type&&((t=document.createElement("video")).autoplay=!0,t.controls=!0,t.loop=!0,t.muted=!0,t.preload=!0,t.style.height="100%",t.style.width="100%"),n.preloadItem(t,r.url),n.cache[e]=t},n.preloadItem=function(e,t){e.src=t},n.setPlaying=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Array.from(document.getElementsByTagName("video")).forEach((function(n){t&&(n.currentTime=0),e?n.play():n.pause()}))},n.setMuted=function(e){Array.from(document.getElementsByTagName("video")).forEach((function(t){t.muted=e})),n.setState({muted:e})},n.state={after:"",activeIndex:-1,loadingNextImages:!1,foundItems:!0,type:"image",muted:!1},n.cache=[],n.list=[],n.settings={urlToFetch:n.getUrlToFetch()},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.getData(),this.addKeyboardEvents()}},{key:"render",value:function(){if(this.state.activeIndex<0)return a.a.createElement("div",null,"Loading...");var e=this.list[this.state.activeIndex];return a.a.createElement("div",{id:"page",className:"App"},a.a.createElement("div",{id:"titleDiv",className:"navbox clouds",style:{left:0}},a.a.createElement("h2",{id:"navboxTitle"},a.a.createElement("a",{href:e.data.url},e.title)),a.a.createElement("h3",null,a.a.createElement("a",{id:"navboxSubreddit",href:e.commentsLink},"/r/".concat(e.subreddit)))),a.a.createElement("div",{ref:"slider",className:"picture-slider"}))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[167,1,2]]]);
//# sourceMappingURL=main.cc826978.chunk.js.map